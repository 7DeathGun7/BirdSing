@model BirdSing.Models.AsignacionDocente
@{
    Layout = "_LayoutAdmin";
    ViewData["Title"] = "Asignar Docente";
}

<h2>Asignar Docente a Materia y Grupo</h2>

<form asp-action="Registro" method="post">
    @Html.AntiForgeryToken()
    <div asp-validation-summary="ModelOnly" class="alert alert-danger"></div>

    <div class="form-group mb-3">
        <label>Docente</label>
        <select asp-for="IdDocente" asp-items="ViewBag.Docentes" class="form-select"></select>
    </div>

    <div class="form-group mb-3">
        <label>Grado</label>
        <select id="gradoSelect" class="form-select">
            <option value="">Seleccione un grado</option>
            @foreach (var grado in (SelectList)ViewBag.Grados)
            {
                <option value="@grado.Value">@grado.Text</option>
            }
        </select>
    </div>

    <div class="form-group mb-3">
        <label>Grupo</label>
        <select asp-for="IdGrupo" asp-items="ViewBag.Grupos" class="form-select" id="grupoSelect"></select>
    </div>

    <div class="form-group mb-3">
        <label>Materia</label>
        <select asp-for="IdMateria" asp-items="ViewBag.Materias" class="form-select"></select>
    </div>


    <button type="submit" class="btn btn-primary">Guardar</button>
    <a asp-action="Lista" class="btn btn-secondary ms-2">Cancelar</a>
</form>

@section Scripts {
    <script>
        document.getElementById('gradoSelect').addEventListener('change', function () {
            const gradoId = this.value;
            const grupoSelect = document.getElementById('grupoSelect');

            fetch(`/Grupos/PorGrado/${gradoId}`)
                .then(res => res.json())
                .then(data => {
                    grupoSelect.innerHTML = '';
                    data.forEach(g => {
                        grupoSelect.innerHTML += `<option value="${g.value}">${g.text}</option>`;
                    });
                });
        });
    </script>
}
